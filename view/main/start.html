<!DOCTYPE html>
<html>
<head>
	<title>WikiFacts</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<link rel="stylesheet" href="../dist/leaflet.css" />
	<link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.2/jquery.mobile-1.3.2.min.css" />

	<!--[if lte IE 8]><link rel="stylesheet" href="../dist/leaflet.ie.css" /><![endif]-->
	<script src="http://code.jquery.com/jquery-1.8.3.min.js"></script>
	<script src="http://code.jquery.com/mobile/1.3.2/jquery.mobile-1.3.2.min.js"></script>
	<script src="http://maps.google.com/maps/api/js?sensor=false"></script>
	<script>
		function checkNewThings(){
			
		}
		$(document).ready(function() {
			$( ".comment_box" ).each(function (i) {
				$(this).height($(this).parent().height()-$(this).next(".current_comment").height()-25);
	      		setInterval ( "checkNewThings()", 1000 );

	      	});
		});
	</script>

	<script>
		if ( navigator.geolocation ) {
			function success(pos) {
				// Location found, show map with these coordinates
				console.log([pos.coords.latitude, pos.coords.longitude]);
			}
			
			function fail(error) {
				
			}
			
			// Find the users current position.  Cache the location for 5 minutes, timeout after 6 seconds
			navigator.geolocation.getCurrentPosition(success, fail, {maximumAge: 500000, enableHighAccuracy:true, timeout: 6000});
		}
	</script>

</head>
<body>


	<div id="main">

<div data-role="page">

	<div data-role="content">
	</div><!-- /content -->

 	<div data-role="panel" data-display="overlay" id="your-location-panel" data-theme="b">
		<div class="comment_box" style="height:450px;font:16px/26px Georgia, Garamond, Serif;overflow:auto;">
		
		</div>
		<div class="current_comment">
        <textarea></textarea> 
 		<button>Comment</button>
 		<button data-theme="a">Snap Picture</button>
 		<button data-theme="a">Rate This</button>
 		</div>
<!--         <a href="#" data-rel="close" data-role="button" data-mini="true" data-inline="true" data-icon="delete" data-iconpos="right">Close</a> -->
    </div><!-- /panel -->

 	<div data-role="panel" data-display="overlay" id="trending-panel" data-theme="b">
		<div class="comment_box" style="height:500px;font:16px/26px Georgia, Garamond, Serif;overflow:auto;">
		Said: new
		</div>
		<div class="current_comment">
        <textarea></textarea> 
 		<button>Comment</button>
 		<button data-theme="a">Snap Picture</button>
 		<button data-theme="a" onclick="pressRate()">Rate This</button>
 		</div>
<!--         <a href="#" data-rel="close" data-role="button" data-mini="true" data-inline="true" data-icon="delete" data-iconpos="right">Close</a> -->
    </div><!-- /panel -->

 	<div data-role="panel" data-display="overlay" id="friends-panel" data-theme="b">
 		<h1>Friend Activity</h1>

		<div class="comment_box" style="height:500px;font:16px/26px Georgia, Garamond, Serif;overflow:auto;">
		things
		</div>
		<div class="current_comment">
        <textarea></textarea> 
 		<button>Comment</button>
 		<button data-theme="a">Snap Picture</button>
 		</div>
<!--         <a href="#" data-rel="close" data-role="button" data-mini="true" data-inline="true" data-icon="delete" data-iconpos="right">Close</a> -->
    </div><!-- /panel -->

 	<div data-role="panel" data-display="overlay" id="nearby-panel" data-theme="b">
		<div class="comment_box" style="height:500px;font:16px/26px Georgia, Garamond, Serif;overflow:auto;">
		
		</div>
		<div class="current_comment">
        <textarea></textarea> 
 		<button>Comment</button>
 		<button data-theme="a">Snap Picture</button>
 		</div>
<!--         <a href="#" data-rel="close" data-role="button" data-mini="true" data-inline="true" data-icon="delete" data-iconpos="right">Close</a> -->
    </div><!-- /panel -->

	<div data-role="header" data-id="foo1" data-position="fixed">
		<div data-role="navbar">
			<ul>
				<li><a href="#your-location-panel" data-shadow="false" data-iconshadow="false" class="ui-icon-nodisc">Your Location</a></li>
				<li><a href="#trending-panel" data-shadow="false" data-iconshadow="false" class="ui-icon-nodisc">Trending</a></li>
				<li><a href="#nearby-panel" data-shadow="false" data-iconshadow="false" class="ui-icon-nodisc">Things Happening Nearby</a></li>
				<li><a href="#friends-panel" data-shadow="false" data-iconshadow="false" class="ui-icon-nodisc">Friends</a></li>
			</ul>
		</div><!-- /navbar -->
	</div><!-- /footer -->

</div><!-- /page -->

		<a href="#" onclick="showMap()">Click here</a>


	</div>

		<div id="map" style="width: 100%; height: 100%"></div>

	</div>

	<script>
		usersPosition = [44.64844, -63.57582];

		function getLocation()
		  {
		  if (navigator.geolocation)
		    {
		    navigator.geolocation.getCurrentPosition(showPosition);
		    }
		  }
		 function showPosition(position)
		  {
		  		usersPosition = [position.coords.latitude, position.coords.longitude];
		  }

	</script>

	<script src="../dist/leaflet.js"></script>
	<script>

		console.log(usersPosition);
		var map = L.map('map').setView(usersPosition, 13);

		L.tileLayer('http://a.tiles.mapbox.com/v3/newms32.map-qor7z0a2/{z}/{x}/{y}.png', {
			maxZoom: 18,
			attribution: ''
		}).addTo(map);


/*		L.marker([51.5, -0.09]).addTo(map)
			.bindPopup("<br/>Recent Updates<br/>More..").openPopup();

		L.circle([51.508, -0.11], 500, {
			color: 'red',
			fillColor: '#f03',
			fillOpacity: 0.5
		}).addTo(map).bindPopup("I am a circle.");

		L.polygon([
			[51.509, -0.08],
			[51.503, -0.06],
			[51.51, -0.047]
		]).addTo(map).bindPopup("I am a polygon.");*/

		var popup = L.popup();

		function onMapClick(e) {
			popup
				.setLatLng(e.latlng)
				.setContent("Bob said: " + e.latlng.toString())
				.openOn(map);
		}

		map.on('click', onMapClick);
	</script>


</body>
</html>
